<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Webhook Tester</title>
<style>
  :root{--bg:#0b0c10;--panel:#111316;--muted:#9aa3af;--text:#e5e7eb;--accent:#60a5fa;--border:#1f2937;--radius:14px}
  @media (prefers-color-scheme: light){:root{--bg:#f7f7fb;--panel:#fff;--text:#0f172a;--muted:#6b7280;--border:#e5e7eb}}
  *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--text);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial}
  .wrap{max-width:900px;margin:auto;padding:20px}
  h1{font-size:20px;margin:0 0 14px}
  .card{background:var(--panel);border:1px solid var(--border);border-radius:var(--radius);padding:16px;margin-bottom:14px}
  label{display:block;font-size:12px;color:var(--muted);margin:10px 0 6px}
  input,textarea,select{width:100%;padding:11px;border-radius:12px;border:1px solid var(--border);background:transparent;color:var(--text)}
  textarea{min-height:120px;resize:vertical}
  .row{display:flex;gap:10px} .row>*{flex:1}
  .btn{appearance:none;border:1px solid var(--border);background:transparent;color:var(--text);padding:10px 14px;border-radius:12px;cursor:pointer}
  .btn.primary{background:linear-gradient(135deg,var(--accent),#8b5cf6);border:none;color:#fff}
  .pill{display:inline-block;border:1px solid var(--border);border-radius:999px;padding:6px 10px;font-size:12px;margin-right:8px}
  pre{white-space:pre-wrap;word-break:break-word;border:1px solid var(--border);border-radius:12px;padding:10px;background:#0f172a;color:#e2e8f0}
  .small{font-size:12px;color:var(--muted)}
</style>
</head>
<body>
<div class="wrap">
  <h1>Webhook Tester</h1>

  <div class="card">
    <div class="row">
      <div>
        <label for="method">Method</label>
        <select id="method">
          <option>POST</option><option>PUT</option><option>PATCH</option>
          <option>GET</option><option>DELETE</option>
        </select>
      </div>
      <div style="flex:3">
        <label for="endpoint">Endpoint URL</label>
        <input id="endpoint" value="https://webhook.site/efcf00a8-841c-4a52-99fa-5acecda707a7" />
      </div>
    </div>

    <div class="row">
      <div>
        <label for="name">Name</label>
        <input id="name" placeholder="Jane Doe" />
      </div>
      <div>
        <label for="email">Email</label>
        <input id="email" type="email" placeholder="jane@example.com" />
      </div>
    </div>

    <div>
      <label for="body">Additional JSON (optional)</label>
      <textarea id="body" placeholder='{"note":"extra fields you want to include"}'></textarea>
      <div class="small">If provided, this JSON will be merged with the Name/Email fields.</div>
    </div>

    <div>
      <label for="headers">Headers (JSON, optional)</label>
      <input id="headers" class="mono" placeholder='{"X-Custom":"123"}' />
      <div class="small">Content-Type will be forced to <code>application/json</code> for non-GET methods.</div>
    </div>

    <div class="row" style="margin-top:10px">
      <button class="btn primary" id="send">Send</button>
      <button class="btn" id="copyCurl">Copy cURL</button>
      <button class="btn" id="clear">Clear</button>
    </div>
  </div>

  <div class="card">
    <div style="margin-bottom:8px">
      <span class="pill">Status: <strong id="status">—</strong></span>
      <span class="pill">Time: <strong id="time">—</strong></span>
      <span class="pill">Size: <strong id="size">—</strong></span>
    </div>
    <label>Response Headers</label>
    <pre id="respHeaders">—</pre>
    <label>Response Body</label>
    <pre id="respBody">—</pre>
  </div>

  <p class="small">Tip: Open the webhook URL in another tab to watch requests arrive in real time.</p>
</div>

<script>
  const $ = (id) => document.getElementById(id);

  function parseJSONSafe(txt, fallback) {
    if (!txt?.trim()) return fallback;
    try { return JSON.parse(txt); } catch { return fallback; }
  }

  function mergePayload(name, email, extraObj) {
    const base = {};
    if (name) base.name = name;
    if (email) base.email = email;
    if (extraObj && typeof extraObj === 'object') {
      return { ...base, ...extraObj };
    }
    return base;
  }

  function buildHeaders(raw, forceJson) {
    const h = Object.fromEntries(Object.entries(parseJSONSafe(raw, {})).map(([k,v]) => [k, String(v)]));
    if (forceJson) h['Content-Type'] = 'application/json';
    return h;
  }

  function buildCurl(method, url, headers, bodyStr) {
    const parts = ['curl','-X',method, `'${url}'`];
    Object.entries(headers).forEach(([k,v]) => { parts.push('-H', `'${k}: ${v}'`); });
    if (bodyStr && method !== 'GET') parts.push('--data', `'${bodyStr.replace(/'/g, `'\\''`)}'`);
    return parts.join(' ');
  }

  $('send').addEventListener('click', async () => {
    const method = $('method').value;
    const url = $('endpoint').value.trim();
    const name = $('name').value.trim();
    const email = $('email').value.trim();
    const extra = parseJSONSafe($('body').value, null);

    if (!url) { alert('Please provide the endpoint URL'); return; }

    const willSendBody = method !== 'GET';
    const payloadObj = willSendBody ? mergePayload(name, email, extra) : null;
    const bodyStr = willSendBody ? JSON.stringify(payloadObj ?? {}) : undefined;
    const headers = buildHeaders($('headers').value, willSendBody);

    const t0 = performance.now();
    let resp, ok=false, text='', size=0;
    try {
      resp = await fetch(url, { method, headers, body: bodyStr });
      ok = resp.ok;
      const buf = await resp.arrayBuffer(); size = buf.byteLength;
      text = new TextDecoder().decode(buf);
    } catch (e) { text = String(e); }
    const ms = Math.round(performance.now() - t0);

    $('status').textContent = resp ? `${resp.status} ${resp.statusText}` : 'NETWORK ERROR';
    $('time').textContent = `${ms} ms`;
    $('size').textContent = `${size}`;
    const hdrs = [];
    if (resp) resp.headers.forEach((v,k)=> hdrs.push(`${k}: ${v}`));
    $('respHeaders').textContent = hdrs.join('\n') || '—';
    $('respBody').textContent = text || '—';
  });

  $('copyCurl').addEventListener('click', () => {
    const method = $('method').value;
    const url = $('endpoint').value.trim() || 'https://webhook.site/efcf00a8-841c-4a52-99fa-5acecda707a7';
    const name = $('name').value.trim();
    const email = $('email').value.trim();
    const extra = parseJSONSafe($('body').value, null);
    const willSendBody = method !== 'GET';
    const payloadObj = willSendBody ? mergePayload(name, email, extra) : null;
    const bodyStr = willSendBody ? JSON.stringify(payloadObj ?? {}) : '';
    const headers = buildHeaders($('headers').value, willSendBody);
    const curl = buildCurl(method, url, headers, bodyStr);
    navigator.clipboard.writeText(curl).then(()=> alert('cURL copied to clipboard'));
  });

  $('clear').addEventListener('click', () => {
    $('name').value = '';
    $('email').value = '';
    $('body').value = '';
    $('headers').value = '';
    $('status').textContent = '—';
    $('time').textContent = '—';
    $('size').textContent = '—';
    $('respHeaders').textContent = '—';
    $('respBody').textContent = '—';
  });
</script>
</body>
</html>
